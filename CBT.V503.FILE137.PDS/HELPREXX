/* REXX EXEC TO CREATE RECORDS TO BE LOADED INTO REPT HELP FILE  */
"EXECIO * DISKR INPUT (FINI STEM INREC."
REC_COUNT = 0
LN_CNT = 0
O_DATA = '                       '
II = 1
DO I=1 TO INREC.0
  IF SUBSTR(INREC.I,1,3) = '$$$' THEN
    DO
      O_TYPE    = SUBSTR(INREC.I,1,3)
      O_TRAN_ID = SUBSTR(INREC.I,4,4)
      O_STATUS  = SUBSTR(INREC.I,9,1)
      O_MAP     = SUBSTR(INREC.I,11,8)
      IF O_STATUS = 'F' THEN
         W_PAGE = 1
       ELSE
         W_PAGE = W_PAGE + 1
      IF O_STATUS = 'O' THEN
         W_PAGE = 1
      SAY 'HELP-RECORD=' O_TRAN_ID LEFT(O_MAP,8,' ') W_PAGE O_STATUS
    OUTREC1 = O_TRAN_ID || LEFT(O_MAP,8,' ') || ,
       RIGHT(W_PAGE,2,0) || O_STATUS || ,
       W_DATA.1 || W_DATA.2 || ,
       W_DATA.3 || W_DATA.4 || W_DATA.5 || W_DATA.6 || W_DATA.7 || ,
       W_DATA.8 || W_DATA.9 || W_DATA.10 || W_DATA.11 || W_DATA.12 || ,
     W_DATA.13 || W_DATA.14 || W_DATA.15 || W_DATA.16 || W_DATA.17 || ,
       W_DATA.18 || W_DATA.19 || W_DATA.20
      QUEUE LEFT(OUTREC1,1615)
      "EXECIO * DISKW OUT1"
      REC_COUNT = REC_COUNT + 1
      II = 1
      ITERATE
    END
  W_DATA.II = INREC.I
  II = II + 1
END
 SAY 'RECORD COUNT = ' REC_COUNT
 EXIT
